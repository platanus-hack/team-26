(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[815],{5042:function(){},7230:function(e,t,s){Promise.resolve().then(s.bind(s,8033))},18:function(e,t,s){"use strict";var r=s(7437);s(2265),t.Z=e=>{let{label:t,icon:s,onClick:a,type:l="button",disabled:n=!1,className:o=""}=e;return(0,r.jsx)("button",{type:l,onClick:a,disabled:n,className:"relative px-0.5 py-0.5 rounded-full font-semibold transition duration-200 ease-in-out\n        text-white \n                ".concat(n?"bg-gray-500 cursor-not-allowed":"bg-blue-500","\n                focus:outline-none hover:opacity-75 active:scale-95 ").concat(o),children:(0,r.jsxs)("span",{className:"flex items-center justify-center w-full h-full bg-gray-900 rounded-full px-4 py-2 ".concat(t?"":"justify-center"),children:[s&&(0,r.jsx)("span",{className:"".concat(t?"mr-2":""),children:s}),t]})})}},8033:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var r=s(7437),a=s(2265),l=s(3464),n=s(9376);let o=(0,a.createContext)(null),i=e=>{let{children:t}=e,[s,i]=(0,a.useState)(null),c=(0,n.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("username");i(e?{username:e.toString()}:null)},[]);let d=async(e,t)=>{let s=await l.Z.post("".concat("https://tensor.zapto.org/constellation/v1/","user/login/"),{username:e,password:t});localStorage.setItem("token",s.data.token),i(s.data.user)};return(0,r.jsx)(o.Provider,{value:{user:s,login:d,logout:()=>{localStorage.removeItem("token"),i(null),c.push("/login")}},children:t})};var c=s(8211),d=s(8614),u=s(6298),m=s(1371),h=e=>{let{isOpen:t,setIsOpen:s,children:a}=e;return(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(d.M,{children:t&&(0,r.jsx)(u.E.div,{className:"fixed right-0 top-0 bottom-0 bg-white shadow-lg z-40 w-[400px] max-w-full flex flex-col",initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"tween",duration:.3},children:(0,r.jsxs)("div",{className:"relative p-6 h-full overflow-y-auto",children:[(0,r.jsx)("button",{className:"absolute top-4 right-4 text-black",onClick:()=>{s(!1)},children:(0,r.jsx)(m.Z,{})}),a]})})})})},x=e=>{var t,s,a;let{isOpen:l,setIsOpen:n,node:o}=e;return(0,r.jsx)(h,{isOpen:l,setIsOpen:n,children:(0,r.jsxs)("div",{className:"text-black",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Experiment Details"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Title"}),(0,r.jsx)("p",{className:"text-gray-700",children:null===(t=o.metadata)||void 0===t?void 0:t.title})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Description"}),(0,r.jsx)("p",{className:"text-gray-700",children:null===(s=o.metadata)||void 0===s?void 0:s.description})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Results"}),(0,r.jsx)("p",{className:"text-gray-700",children:null===(a=o.metadata)||void 0===a?void 0:a.results})]})]})})},g=s(18),f=s(8682),p=e=>{let{search:t,setSearch:s,handleSendInput:l}=e,n=(0,a.useRef)(null);return(0,a.useEffect)(()=>{n.current&&(n.current.style.height="auto",n.current.style.height="".concat(n.current.scrollHeight,"px"))},[t]),(0,r.jsx)("div",{className:"flex flex-row",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsxs)("div",{className:"flex flex-row w-[40vw]",children:[(0,r.jsx)("textarea",{ref:n,placeholder:"Describe your experiment here...",value:t,onChange:e=>{e.target.value.length<=1e3&&s(e.target.value)},className:"w-full p-2 text-black dark:text-white bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-300 dark:border-gray-700",rows:1,maxLength:1e3,style:{resize:"none",overflow:"hidden"}}),(0,r.jsx)(g.Z,{onClick:l,className:"flex justify-center items-center ml-2 text-sm h-12 w-12",icon:(0,r.jsx)(f.Z,{})})]}),(0,r.jsxs)("small",{className:"text-white dark:text-gray-400 mt-1",children:[t.length,"/",1e3," characters"]})]})})},v=e=>{let{search:t,setSearch:s,handleSendSearch:a}=e;return(0,r.jsxs)("div",{className:"flex items-center w-[40vw]",children:[(0,r.jsx)("input",{className:"w-full p-2 text-black dark:text-white bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-300 dark:border-gray-700",type:"text",value:t,onChange:e=>s(e.target.value),placeholder:"Search an specific experiment..."}),(0,r.jsx)(g.Z,{onClick:a,className:"flex justify-center items-center ml-2 text-sm h-12 w-12",icon:(0,r.jsx)(f.Z,{})})]})},j=s(8209),b=s(4008),y=e=>{let{checked:t=!1,onChange:s,disabled:l=!1,className:n="",onIcon:o,offIcon:i}=e,[c,d]=(0,a.useState)(t);return(0,r.jsx)("div",{onClick:()=>{if(l)return;let e=!c;d(e),s&&s(e)},className:"relative flex items-center cursor-pointer w-16 h-8 rounded-full p-1 \n        transition-colors duration-200 ease-in-out\n        ".concat(l?"bg-gray-400 cursor-not-allowed":c?"bg-blue-500":"bg-gray-500","\n        ").concat(n),children:(0,r.jsx)("div",{className:"absolute left-1 flex items-center justify-center w-7 h-7 rounded-full bg-white transition-transform duration-200 ease-in-out\n          ".concat(c?"translate-x-8":""),children:c?o:i})})},w=e=>{let{nodes:t}=e,[s,l]=(0,a.useState)(!1),[n,o]=(0,a.useState)(null),i=e=>{o(e),l(!0)};return(0,r.jsxs)("div",{className:"columns-1 sm:columns-2 lg:columns-3 xl:columns-4 gap-4 p-4 mt-12",children:[t.map(e=>{var t,s,a,l;return(0,r.jsxs)("div",{className:"mb-4 break-inside-avoid shadow-md hover:shadow-lg transition-shadow p-6 rounded-lg bg-[#f9f9f9]",onClick:()=>i(e),children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-gray-800 truncate",children:null===(t=e.metadata)||void 0===t?void 0:t.title}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:null===(s=e.metadata)||void 0===s?void 0:s.description}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("span",{className:"block text-sm font-semibold text-gray-700",children:"Results:"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:null===(a=e.metadata)||void 0===a?void 0:a.results})]}),(0,r.jsx)("div",{className:"mt-2 flex items-center",children:(0,r.jsxs)("span",{className:"inline-block bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs font-medium",children:["Cluster ",null===(l=e.metadata)||void 0===l?void 0:l.cluster]})})]},e.id)}),s&&n&&(0,r.jsx)(x,{isOpen:s,setIsOpen:l,node:n})]})};let N=l.Z.create({baseURL:"https://tensor.zapto.org/constellation/v1/"}),k=!1,S=[],I=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;S.forEach(s=>{e?s.reject(e):s.resolve(t)}),S=[]};N.interceptors.request.use(e=>{let t=localStorage.getItem("access");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),N.interceptors.response.use(e=>e,e=>{let t=e.config;if(e.response&&401===e.response.status&&!t._retry){if(k)return new Promise(function(e,t){S.push({resolve:e,reject:t})}).then(e=>(t.headers.Authorization="Bearer "+e,N(t))).catch(e=>Promise.reject(e));t._retry=!0,k=!0;let s=localStorage.getItem("refresh");return s?new Promise(function(e,r){l.Z.post("https://tensor.zapto.org/constellation/v1//users/token/refresh",{refresh:s}).then(s=>{let{data:r}=s,a=r.access;localStorage.setItem("access",a),N.defaults.headers.common.Authorization="Bearer "+a,t.headers.Authorization="Bearer "+a,I(null,a),e(N(t))}).catch(e=>{I(e,null),localStorage.removeItem("access"),localStorage.removeItem("refresh"),r(e)}).finally(()=>{k=!1})}):(localStorage.removeItem("access"),localStorage.removeItem("refresh"),Promise.reject(e))}return Promise.reject(e)});let C=e=>"hsl(".concat(.618033988749895*e%1*360,", 50%, 30%)"),Z=e=>{var t;let s=null===(t=e.metadata)||void 0===t?void 0:t.cluster;return void 0!==s?C(s):"gray"};function z(e){let{nodes:t,links:s,setNodes:l,setLinks:n}=e,[o,i]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(""),[g,f]=(0,a.useState)(""),[k,S]=(0,a.useState)(!1),[I,C]=(0,a.useState)(!0),z=(0,a.useRef)(null),E=async e=>{e&&(i(!0),u(e))},R=async()=>{try{let{cosmograph_data:e,metadata:t}=(await N.post("/knowledge/search",{query:g})).data,s=e.map(e=>({source:e.source,target:e.target})),r=t.map(e=>({id:e.id,metadata:{title:e.title,description:e.description,results:e.results,cluster:e.cluster,isRepresentative:e.is_representative,category:e.category}}));l(r),n(s),S(!0)}catch(e){console.error("Error sending input:",e)}};return(0,r.jsxs)(c.g$,{nodes:t,links:s,children:[(0,r.jsx)("div",{className:"absolute top-4 left-4 p-2 rounded shadow z-20",children:(0,r.jsx)(y,{className:"text-black",offIcon:(0,r.jsx)(j.Z,{className:"p-1"}),onIcon:(0,r.jsx)(b.Z,{className:"p-1"}),onChange:()=>C(!I)})}),!k&&(0,r.jsx)("div",{className:"absolute h-full w-full z-10"}),(0,r.jsx)("div",{className:"absolute transition-all duration-500 ease-in-out ".concat(k?"top-2 left-1/2 transform -translate-x-1/2":"top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 "," z-10"),children:k?(0,r.jsx)(v,{search:m,setSearch:h,handleSendSearch:()=>{console.log("Search:",m)}}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(p,{search:g,setSearch:f,handleSendInput:R})})}),I?(0,r.jsx)(c.XH,{ref:z,nodeSize:1,linkWidth:1,linkArrows:!1,nodeColor:Z,nodeLabelClassName:"flex text-white rounded-xl p-1",nodeLabelAccessor:e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.title)||"No Title"},hoveredNodeRingColor:"red",showLabelsFor:t.filter(e=>{var t;return null===(t=e.metadata)||void 0===t?void 0:t.isRepresentative}),style:{width:"100%",height:"100vh"},simulationFriction:.03,simulationLinkSpring:.5,simulationRepulsion:.5,simulationLinkDistance:2,simulationGravity:.5,showDynamicLabels:!1,renderLinks:!0,onClick:E,backgroundColor:"#191919",linkVisibilityDistanceRange:[0,1]}):(0,r.jsx)(w,{nodes:t}),d&&(0,r.jsx)(x,{isOpen:o,setIsOpen:i,node:d})]})}var E=s(6197),R=s(8763),L=()=>{let[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)([]),{logout:n}=(0,E.Z)();return(0,a.useEffect)(()=>{(async()=>{try{let{cosmograph_data:e,metadata:s}=(await N.get("/knowledge/knowledge-graph")).data,r=e.map(e=>({source:e.source,target:e.target})),a=s.map(e=>({id:e.id,metadata:{title:e.title,description:e.description,results:e.results,cluster:e.cluster,isRepresentative:e.is_representative,category:e.category}}));t(a),l(r)}catch(e){console.error("Error fetching knowledge graph data:",e)}})()},[]),(0,r.jsxs)("div",{children:[0===e.length?(0,r.jsx)("div",{className:"flex flex-col w-full p-4 bg-gray-100 dark:bg-[#191919]",children:(0,r.jsx)("div",{className:"flex flex-grow items-center justify-center",children:(0,r.jsx)("h1",{className:"text-xl font-bold mb-4",children:"Loading..."})})}):(0,r.jsx)("div",{className:"flex flex-col w-full p-0",children:(0,r.jsx)(z,{nodes:e,links:s,setNodes:t,setLinks:l})}),(0,r.jsx)("button",{onClick:n,className:"absolute top-4 right-4 p-2 bg-red-500 text-white rounded-md z-30 hover:bg-red-600",children:(0,r.jsx)(R.Z,{})})]})},_=()=>(0,r.jsx)(i,{children:(0,r.jsx)(L,{})})},6197:function(e,t,s){"use strict";var r=s(2265),a=s(3464),l=s(9376);t.Z=()=>{let[e,t]=(0,r.useState)(null),s=(0,l.useRouter)();return(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),s=localStorage.getItem("username");e&&s&&t({username:s})},[]),{user:e,login:async(e,s,r)=>{try{let r=await a.Z.post("https://tensor.zapto.org/constellation/v1/users/login",{username:e,password:s}),l=r.data.access,n=r.data.refresh;return localStorage.setItem("token",l),localStorage.setItem("refreshToken",n),localStorage.setItem("username",e),t({username:e}),!0}catch(e){return r(a.Z.isAxiosError(e)&&e.response&&(400===e.response.status||401===e.response.status)?"Invalid credentials":"An unexpected error occurred"),!1}},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("username"),t(null),s.push("/login")},isAuthenticated:()=>!!localStorage.getItem("token")}}}},function(e){e.O(0,[530,301,263,971,117,744],function(){return e(e.s=7230)}),_N_E=e.O()}]);